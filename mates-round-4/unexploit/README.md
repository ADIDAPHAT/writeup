Bài này cho mình một đoạn code ngăn ngắn và mình chính thấy lỗi là `stack overflow` ở đây.

```c
__int64 __fastcall sub_400286(__int64 a1, __int64 a2)
{
  __int64 v2; // rdx
  __int64 v3; // rcx
  __int64 v4; // r8
  __int64 v5; // r9
  __int64 v6; // rdx
  __int64 v7; // rcx
  __int64 v8; // r8
  __int64 v9; // r9
  __int64 v10; // rcx
  __int64 v11; // r8
  __int64 v12; // r9
  char v14; // [rsp+2Ch] [rbp-4h]

  sub_40038F(60LL);
  sub_400228((__int64)"Not all the bugs are exploitable.\n", a2, v2, v3, v4, v5);
  sub_400228((__int64)"Now, the environment is also strict. Can you exploit me anyway?\n", a2, v6, v7, v8, v9);
  sub_40036D(0LL, (__int64)&v14, 100LL, v10, v11, v12);
  return 0LL;
}
```
Ngoài ra `bss executable` nên mình chọn cách là `ret lại `.text:00000000004002BB                 lea     rax, [rbp+var_4]` sau khi control `rbp` để ghi vào bss và lại ret về bss đó.

Ghi vào bss nhưng lại chỉ có thể ghi 100 byte nên không thể ghi đủ được luôn reverse tcp shell được nên lại dùng shellcode ghi thêm vào bss đó để có thể ghi được nhiều hơn.

Từ đó mình có solution (Payload mình gen lại vào file up lên web page để back connect lại về server của mình)

[solution.py](solution.py)